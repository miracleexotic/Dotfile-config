- name: "| zsh | Install require library"
  apt:
    pkg:
      - build-essential
      - gcc
      - cmake
      - zsh
      - bat
      - fzf
      - tree
      - btop
    update_cache: yes
  register: result
- name: Print out
  debug:
    var: result

- name: "| zsh | Get zsh path"
  shell: which zsh
  args:
    executable: /bin/bash
  register: zsh
- name: Print out
  debug:
    var: zsh

- name: "| zsh | Change user shell to zsh"
  user:
    name: "{{ user }}"
    shell: "{{ zsh.stdout }}"
  register: result
- name: Print out
  debug:
    var: result

- name: "| zsh | Install zplug"
  become_user: "{{ user }}"
  shell: curl -sL --proto-redir -all,https https://raw.githubusercontent.com/zplug/installer/master/installer.zsh | zsh
  args:
    chdir: /home/{{ user }}
    executable: "{{ zsh.stdout }}"
  register: result
- name: Print out
  debug:
    var: result

- name: "| zsh | Install Rust cargo"
  become_user: "{{ user }}"
  shell: curl https://sh.rustup.rs -sSf | sh -s -- -y
  args:
    chdir: /home/{{ user }}
    executable: "{{ zsh.stdout }}"
  register: result
- name: Print out
  debug:
    var: result

- name: "| zsh | source cargo"
  shell: source /home/{{ user }}/.cargo/env
  args:
    chdir: /home/{{ user }}
    executable: "{{ zsh.stdout }}"
  register: result
- name: Print out
  debug:
    var: result

- name: "| zsh | Install exa via cargo"
  become_user: "{{ user }}"
  shell: cargo install exa
  args:
    executable: "{{ zsh.stdout }}"
  register: result
- name: Print out
  debug:
    var: result

- name: "| zsh | Git Clone enhancd"
  become_user: "{{ user }}"
  git:
    repo: "https://github.com/b4b4r07/enhancd"
    dest: "/home/{{ user }}/enhancd"
  register: result
- name: Print out
  debug:
    var: result

- name: "| zsh | source enhancd"
  shell: source /home/{{ user }}/enhancd/init.sh
  args:
    chdir: /home/{{ user }}
    executable: "{{ zsh.stdout }}"
  register: result
- name: Print out
  debug:
    var: result

- name: "| zsh | Link .zshrc file"
  shell: ln -s /home/{{ user }}/Dotfile-config/zsh/.zshrc /home/{{ user }}/.zshrc
  args:
    chdir: /home/{{ user }}
    executable: "{{ zsh.stdout }}"
  register: result
- name: Print out
  debug:
    var: result
